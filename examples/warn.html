<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beforeunload Example</title>
</head>
<body>
    <h1>Unsaved Data Warning</h1>
    <form id="myForm">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" placeholder="Enter your name">
        <br>
        <label for="message">Message:</label>
        <textarea id="message" name="message" rows="5" placeholder="Write your message"></textarea>
        <br>
        <button type="submit">Submit</button>
    </form>
    <a href="https://www.google.com" target="_blank"> chrome</a>

    <script>
     window.addEventListener("beforeunload", function (event) {
    // Prevent the default behavior (optional)
  
  
  //  event.preventDefault();
debugger;
    // Prepare data to be sent in the POST request
    const postData = {
        exhibition_ID:'3',
    start:'1',
    end:'10',
    category:"0",
    businesscategorylevel1:'Dental Supplies',
    uno:'0'
    };

    // Perform an asynchronous POST request using the Fetch API
    fetch('https://stage.marketcentral.in/rest/virtualExpo/general/virtualExhibitionDetails', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(postData)
    })
    .then(response => {
        // Check if the response is successful
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        console.log('Response status:', response.status);
    return response.json();
        // Return the response JSON data
       // return response.json();
    })
    .then(json => {
        // Handle the response data
        console.log('POST request successful:', json);
    })
    .catch(error => {
        // Handle errors
        console.error('Error:', error.message);
    });
    
    console.log("done");
    console.log("second")
});




//         window.addEventListener("beforeunload", function () {
//             debugger;
//           setInterval(alert("heyy"),10000)

//           console.log("code piece")
//        APICALL()
//           alert("elloo")
//           alert("babjii")
//             // Check if there's unsaved data (form fields)
//             // if (hasUnsavedData()) {
//             //     // Prevent default browser behavior (optional)
//             //     showUnsavedDataModal() 
//               //   event.preventDefault();

//             //     // Set a meaningful message for the confirmation dialog
              
//             //     event.returnValue = "heaii"; // Chrome requires an empty string
//             //     // Store the warning flag in localStorage
//             //     localStorage.setItem("warn", "true");
//             //     console.log("executed")
//             //     alert("he;;")
//             // } else {
//             //     // No need to warn, remove the flag if it exists
//             //     localStorage.removeItem("warn");
//             // }
//         });
// function APICALL(){
//     fetch('https://dev.marketcentral.in/rest/virtualExpo/general/getBusinesses/3')
// .then(response => response.json())
// .then(apiData => {
//     data = apiData; // Assign data from API to the global variable
//     console.log(data);
//     // createCards(data);
// })
// .catch(error => {
//       console.error("Error fetching API data:", error);
//       // Handle API call errors gracefully (e.g., log to server, display user-friendly message)
//     });
// }
//         function hasUnsavedData() {
//             const form = document.getElementById("myForm");
//             if (form) {
//                 for (const element of form.elements) {
//                     if (element.type === "text" || element.type === "textarea") {
//                         if (element.value !== "") {
//                             return true;
//                         }
//                     }
//                 }
//             }
//             return false;
//         }

        function showUnsavedDataModal() {
  // Create the modal container (div element)
  const modalContainer = document.createElement("div");
  modalContainer.id = "unsaved-data-modal"; // Set a unique ID
  modalContainer.classList.add("modal"); // Add a CSS class for styling (optional)
  modalContainer.style.display = "block"; // Make the modal visible initially

  // Create the modal content (div element)
  const modalContent = document.createElement("div");
  modalContent.classList.add("modal-content"); // Add a CSS class for styling (optional)

  // Add the modal title (h2 element)
  const modalTitle = document.createElement("h2");
  modalTitle.textContent = "Are you sure you want to leave?";
  modalContent.appendChild(modalTitle);

  // Add the modal message (p element)
  const modalMessage = document.createElement("p");
  modalMessage.textContent = "You have unsaved data. Leaving the page may cause you to lose your progress.";
  modalContent.appendChild(modalMessage);

  // Create buttons container (div element)
  const buttonsContainer = document.createElement("div");
  buttonsContainer.classList.add("modal-buttons"); // Add a CSS class for styling (optional)

  // Create "Cancel" button (button element)
  const cancelButton = document.createElement("button");
  cancelButton.textContent = "Cancel";
  cancelButton.addEventListener("click", function() {
    // Close the modal when clicked
    modalContainer.style.display = "none";

    // Allow the browser's default behavior (optional)
    event.preventDefault(); // Remove if you want to prevent default behavior even on cancel
  });
  buttonsContainer.appendChild(cancelButton);

  // Create "Leave" button (button element)
  const leaveButton = document.createElement("button");
  leaveButton.textContent = "Leave Page";
  leaveButton.addEventListener("click", function() {
    // Close the modal when clicked
    modalContainer.style.display = "none";

    // Allow the browser's default behavior (optional)
    // Remove this line if you want to prevent default behavior even on leave
  });
  buttonsContainer.appendChild(leaveButton);

  // Append buttons container to modal content
  modalContent.appendChild(buttonsContainer);

  // Append modal content to modal container
  modalContainer.appendChild(modalContent);

  // Add the modal container to the body (important)
  document.body.appendChild(modalContainer);

  // Add a function to close the modal when clicking outside (optional)
  function closeModalOnClickOutside(e) {
    if (e.target === modalContainer) {
      modalContainer.style.display = "none";
      // Allow the browser's default behavior (optional)
      event.preventDefault(); // Remove if you want to prevent default behavior even on outside click
    }
  }
  window.addEventListener("click", closeModalOnClickOutside); // Remove if not needed

  // Remember to style the modal using CSS for a better user experience (optional)
}

    </script>
</body>
</html>
