<html>

<head>
  <meta charset="utf-8" />
  <title>Nametag Example — Networked-Aframe</title>
  <meta name="description" content="Nametag — Networked-Aframe" />
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.5.0/socket.io.slim.js"></script>
  <script src="/easyrtc/easyrtc.js"></script>
  <script src="/dist/networked-aframe.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.2.0/dist/aframe-extras.controls.min.js"></script>
  <script src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>
  <script src="/js/spawn-in-circle.component.js"></script>
  <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
  <link rel="stylesheet" href="css/hall.css">
  <!-- <script src="/js/script.js"></script>
<script src="/js/simple-navmesh-constraint.js"></script> -->
  <script src="/js/joystick.js"></script>
  <script>
    // Get the query string from the current URL
    const queryString = window.location.search;

    // Create a new URLSearchParams object from the query string
    const urlParams = new URLSearchParams(queryString);

    // Get the value of a specific parameter
    var category = urlParams.get('category');
    category = category.replace(/\s/g, '');

    // alert(category)
    AFRAME.registerComponent('pulse-on-approach', {
      init: function () {
        // Store original scale and find the camera
        this.originalScale = this.el.getAttribute('scale');
        this.camera = document.getElementById('player');
        if (!this.camera) {
          console.error('Camera not found');
          return;
        }

        // Set up animation
        this.el.setAttribute('animation__pulse', {
          property: 'scale',
          dir: 'alternate',
          dur: 1000,
          easing: 'easeInOutQuad',
          to: {
            x: this.originalScale.x * 4.1,
            y: this.originalScale.y * 4.1,
            z: this.originalScale.z * 4.1
          },
          loop: true,
          enabled: false // Initially disabled
        });
      },
      tick: function () {
        if (!this.camera) return;

        // Get positions
        const cameraPosition = this.camera.object3D.position;
        //console.log('camera is')
        //console.log(cameraPosition)
        const elPosition = this.el.object3D.position;
        //console.log("popup-p is")
        //console.log(elPosition)
        // Calculate distance
        const distance = cameraPosition.distanceTo(elPosition);
        //console.log("distance is")
        //console.log(distance)
        // Toggle animation based on distance
        if (distance < 5) {
          this.el.setAttribute('animation__pulse', 'enabled', true);
        } else {
          this.el.setAttribute('animation__pulse', 'enabled', false);
        }
      }
    });
    // Temporary workaround for template declaration; see issue 167
    NAF.schemas.getComponentsOriginal = NAF.schemas.getComponents;
    NAF.schemas.getComponents = (template) => {
      if (!NAF.schemas.hasTemplate('#head-template')) {
        NAF.schemas.add({
          template: '#head-template',
          components: [
            'position',
            'rotation',

            // In this example, we don't sync the material.color itself, like the basic example;
            // we instead sync player-info, which includes color setting + updating.
            // (you can see an example of the other pattern in the basic.html demo)
            'player-info',
            {
              selector: '.model',
              component: 'gltf-model'
            }

          ]
        });
      }

      const components = NAF.schemas.getComponentsOriginal(template);
      return components;
    };
  </script>

  <script>
    window.ntExample = {
      randomColor: () => {
        return '#' + new THREE.Color(Math.random(), Math.random(), Math.random()).getHexString();
      }
    };

    AFRAME.registerComponent('player-info', {
      // notice that color and name are both listed in the schema; NAF will only keep
      // properties declared in the schema in sync.
      schema: {
        name: { type: 'string', default: 'user-' + Math.round(Math.random() * 10000) },
        color: {
          type: 'color', // btw: color is just a string under the hood in A-Frame
          default: window.ntExample.randomColor()
        }
      },

      init: function () {
        this.head = this.el.querySelector('.head');
        this.nametag = this.el.querySelector('.nametag');

        this.ownedByLocalUser = this.el.id === 'player';
        if (this.ownedByLocalUser) {
          // populate the html overlay with the correct name on init
          this.nametagInput = document.getElementById('username-overlay');
          this.nametagInput.value = this.data.name;

          // add the initial color to the html overlay color picker button
          document.querySelector('#color-changer').style.backgroundColor = this.data.color;
          document.querySelector('#color-changer').style.color = this.data.color;
        }
      },
      // here as an example, not used in current demo. Could build a user list, expanding on this.
      listUsers: function () {
        console.log(
          'userlist',
          [...document.querySelectorAll('[player-info]')].map((el) => el.components['player-info'].data.name)
        );
      },

      newRandomColor: function () {
        this.el.setAttribute('player-info', 'color', window.ntExample.randomColor());
      },

      update: function () {
        if (this.head) this.head.setAttribute('material', 'color', this.data.color);
        if (this.nametag) this.nametag.setAttribute('value', this.data.name);
        const secondNametag = this.el.querySelector('.nametag:nth-child(2)');
        if (secondNametag) secondNametag.setAttribute('value', this.data.name);
      }
    });
  </script>
  <style>
    #restartButton {
      position: fixed;
      z-index: 999;
      top: 80px;
      left: 20px;
    }

    #form-field {
      position: fixed;
      z-index: 999;
      top: 65px;
      left: 20px;
    }

    #iframe-container {

      position: fixed;
      top: 150px;
      left: 20px;
      display: none;
      width: 100px;
      height: 200px
    }

    #iframe-url {

      position: fixed;
      top: 150px;
      left: 20px;
      display: none;
      width: 500px;
      height: 500px;
      border: 0px;
    }

    #iframe-container {

      position: fixed;
  
      top: 150px;
      left: 20px;
      display: none;
      width: 100px;
      height: 200px
    }

    #iframe-url {

      position: fixed;
      top: 150px;
      left: 20px;
      display: none;
      width: 500px;
      height: 500px;
      border: 0px;
    }
  </style>
</head>

<body>

  <div class="popUp" id="popup">
    <div class="popUpContents">
        <img class="closeIcon" src="images/closeButton.png">
        <img class="productImg" id="productimge"src="images/productImg.png">
        <div class="productDetails">
            <div class="priceDetails">
                <p class="productName" id="prdt-name">Product Name</p>
                <p class="productPrice" id="prd-price">Price : <span class="price" id="cost">₹2,795</span>/<span class="productWeight" id="prdt-units"> kilogram(kg)</span></p>    
            </div>
            <a class="visitProductButton" href="" id="visit-prdt-btn" target="_blank">Visit Product</a>
           </div>
    </div>
</div>
  <!-- <button id="restartButton">Restart Scene</button> -->
  <!-- This <button> and <input> will overlay on top of the A-Frame canvas--this style is all you need.
         Note the onclick and oninput attributes; on every call, they will run .setAttribute() for the player-info
         component's data. NAF will keep that property in sync, since 'name' and 'color' are declared in the schema
         of the 'player-info' component
    -->
  <button id="color-changer" style="z-index: 100; bottom: 24px; left: 24px; position: fixed;display: none;" onclick="let newColor = window.ntExample.randomColor();
             document.getElementById('player').setAttribute('player-info', 'color', newColor);
             document.querySelector('#color-changer').style.backgroundColor = newColor;
             document.querySelector('#color-changer').style.color = newColor;
    "> ■
  </button>

  <input id="username-overlay" style="z-index: 100; bottom: 24px; left: 48px; position: fixed;display: none;"
    oninput="document.getElementById('player').setAttribute('player-info', 'name', this.value)" />
  <!-- <div id="iframe-container">
    <iframe id="iframe-url" src=""></iframe>
  </div> -->

  <!-- <div id="iframe-container2">
    <iframe id="iframe-url2" src=""></iframe>
  </div> -->
  <script>
    window.onload = function () {
      let newColor = window.ntExample.randomColor();
      document.getElementById('player').setAttribute('player-info', 'color', newColor);
      document.querySelector('#color-changer').style.backgroundColor = newColor;
      document.querySelector('#color-changer').style.color = newColor;
      setname();
    };
    function setname() {
     // alert('hey')
      var name = localStorage.getItem('UserName');
      document.getElementById('player').setAttribute('player-info', 'name', name)
      // localStorage.setItem('name',name)
      // alert(localStorage.getItem('UserName'))
    }
    
  </script>
  <script src="js/halljs/hall.js"></script>
  <a-scene id="scene1" networked-scene="
        debug: true;
        adapter: wseasyrtc;
    " joystick xr-mode-ui="enabled: false"
    cursor="rayOrigin:mouse">
    <a-assets>
      <!-- //stallmodel  -->
      <a-asset-item id="stall" src="assets/stallmodel/stall ver2 empty.glb"></a-asset-item>
       <!-- //3dcharacter  -->
      <a-mixin id="boy-character" src="assets/3dmodels/Male_LongSleeve.glb" person-events-component>
      </a-mixin>
      <template id="head-template">
        <a-entity class="avatar">
          <a-entity gltf-model="#boy-character" class="model" position="0 -4 2" visible="true" scale="1 1 1"
            rotation="0 180 0">
          </a-entity>
          <a-plane color="red" position="0.25 1.25 2" scale="2 0.5 0.1" side="double" look-at="[camera]">
            <a-text class="nametag" value="?" rotation="0 180 0" position="0 0.1 -0.25" align="center"
              color="black"></a-text>
            <a-text class="nametag" value="?" position="0 0.1 1.2" align="center" color="black"></a-text>
          </a-plane>
        </a-entity>

      </template>
       <!-- //hallmodel  -->
      <a-asset-item id="hallmodel" src="assets/hallmodel/hall layout empty.glb"></a-asset-item>
    </a-assets>
   
    <a-entity gltf-model="#hallmodel">
      <!-- camera start -->
   
     <a-entity id="player" user-height="2"  camera position="0 2.5 0" wasd-controls networked="template:#head-template;"
    visible="true" xr-mode-ui="enabled:false" look-controls="magicWindowTrackingEnabled:false"
    touchEabled="true">
  </a-entity>


      <!-- camera end -->
      <!-- stall 1 -->
      <a-plane position="-26.677 0.100 -11.412" color="white" width="15" height="15" rotation="90 0 0" side="double"
       class="trigger" alert-on-approach id="area1">
        <a-entity gltf-model="#stall" id="stall1" position="-0.047 0.398 -0.104" rotation="-90 0 0" scale="0.85 0.85 0.85">
          <!-- <a-plane color="#FBFBFB" id="popup1" rotation="0 90 0" position="5.2 2 14.25" width="2.5" height="1.2"
            visible="true"></a-plane> -->
          <!-- <a-entity text="value:helloo;color:black" position="6 2 14.25" id="txt1"></a-entity> -->
            <!-- <a-box color="blue" position=""></a-box> -->
            <a-entity id="txt1" rotation="0 90 0" scale="1 1 1" position="6 2 14.25">
              <a-text id="txtval1" value="12345" color="black"></a-text>
            </a-entity>
          </a-entity>
      </a-plane>
      <a-box id="pp1" position="-26.677 0.100 -0.829" pulse-on-approach scale="1 1 1" color="red"></a-box>

      <!-- stall 2 -->
      <a-plane position="-26.584 0.100 -41.96" color="white" width="15" height="15" rotation="90 0 0" side="double"
        class="trigger" alert-on-approach id="area2">
        <a-entity gltf-model="#stall" id="stall2" position="-0.047 0.398 -0.104" scale="0.85 0.85 0.85" rotation="-90 0 0">
          <a-plane color="#FBFBFB" id="popup2" rotation="0 90 0" position="5.2 2 14.25" width="2.5" height="1.2"
            visible="true"></a-plane>
          <!-- <a-entity text="value:helloo;color:black" position="6 2 14.25" id="txt1"></a-entity> -->
          <a-entity id="txt2" rotation="0 90 0" scale="1 1 1" position="6 2 14.25">
            <a-text id="txtval2" value="12345" color="black"></a-text>
          </a-entity>
        </a-entity>
      </a-plane>
      <a-box id="pp2" position="-26.584 0.100 -33.151" pulse-on-approach scale="1 1 1" color="red"></a-box>

      <!-- stall 3 -->
      <a-plane position="-27.857 0.100 -71.2" color="white" width="15" height="15" rotation="90 0 0" side="double"
        class="trigger" alert-on-approach id="area3">
        <a-entity gltf-model="#stall" id="stall3" rotation="-90 0 0" position="-1.542 0.813 0.100" scale="0.85 0.85 0.85">
          <a-plane color="#FBFBFB" id="popup3" rotation="0 90 0" position="5.2 2 14.25" width="2.5" height="1.2"
            visible="true"></a-plane>
          <!-- <a-entity text="value:helloo;color:black" position="6 2 14.25" id="txt1"></a-entity> -->
          <a-entity id="txt3" rotation="0 90 0" scale="1 1 1" position="6 2 14.25">
            <a-text id="txtval3" value="123456" color="black"></a-text>
          </a-entity>
        </a-entity>
      </a-plane>
      <a-box id="pp3" position="-27.857 0.100 -74.749" pulse-on-approach scale="1 1 1" color="red"></a-box>

      <!-- stall 4 -->
      <a-plane position="-25 0.100 -100.71" color="white" width="15" height="15" rotation="90 0 0" side="double"
        class="trigger" alert-on-approach id="area4">
        <a-entity gltf-model="#stall" id="stall4" rotation="-90 0 0" position="-1.542 0.813 0.100" scale="0.85 0.85 0.85">
          <a-plane color="#FBFBFB" id="popup4" rotation="0 90 0" position="5.2 2 14.25" width="2.5" height="1.2"
            visible="true"></a-plane>
          <!-- <a-entity text="value:helloo;color:black" position="6 2 14.25" id="txt1"></a-entity> -->
          <a-entity id="txt4" rotation="0 90 0" scale="1 1 1" position="6 2 14.25">
            <a-text id="txtval4" value="1234567" color="black"></a-text>
          </a-entity>
        </a-entity>
      </a-plane>
      <a-box id="pp4" position="-29.919 0.100 -113.891" pulse-on-approach scale="1 1 1" color="red"></a-box>

<!-- stall 5 -->
      <a-plane position="-9.555 0.100 -121.016" color="white" width="15" height="15" rotation="90 -90 0" side="double"
        class="trigger" alert-on-approach id="area5">
        <a-entity gltf-model="#stall" id="stall5" rotation="-90 0 0" position="-1.542 0.813 0.100" scale="0.85 0.85 0.85">
          <a-plane color="#FBFBFB" id="popup5" rotation="0 90 0" position="5.2 2 14.25" width="2.5" height="1.2"
            visible="true"></a-plane>
          <!-- <a-entity text="value:helloo;color:black" position="6 2 14.25" id="txt1"></a-entity> -->
          <a-entity id="txt5" rotation="0 90 0" scale="1 1 1" position="6 2 14.25">
            <a-text id="txtval5" value="1234567" color="black"></a-text>
          </a-entity>
        </a-entity>
      </a-plane>
      <a-box id="pp5" position="-20.346 0.100 -126.424" pulse-on-approach scale="1 1 1" color="red"></a-box>

<!-- stall 6-->
      <a-plane position="16.257 0.100 -120.676" color="white" width="15" height="15" rotation="90 -90 0" side="double"
        class="trigger" alert-on-approach id="area6">
        <a-entity gltf-model="#stall" id="stall6" rotation="-90 0 0" position="-1.542 0.813 0.100" scale="0.85 0.85 0.85">
          <a-plane color="#FBFBFB" id="popup6" rotation="0 90 0" position="5.2 2 14.25" width="2.5" height="1.2"
            visible="true"></a-plane>
          <!-- <a-entity text="value:helloo;color:black" position="6 2 14.25" id="txt1"></a-entity> -->
          <a-entity id="txt6" rotation="0 90 0" scale="1 1 1" position="6 2 14.25">
            <a-text id="txtval6" value="1234567" color="black"></a-text>
          </a-entity>
        </a-entity>
      </a-plane>
      <a-box id="pp6" position="12.197 0.100 -117.155" pulse-on-approach scale="1 1 1" color="red"></a-box>

      <!-- stall 7 -->
      <a-plane position="25.454 0.100 -97.305" color="white" width="15" height="15" rotation="90 180 0" side="double"
        class="trigger" alert-on-approach id="area7">
        <a-entity gltf-model="#stall" id="stall7" rotation="-90 0 0" position="-1.542 0.813 0.100" scale="0.85 0.85 0.85">
          <a-plane color="#FBFBFB" id="popup7" rotation="0 90 0" position="5.2 2 14.25" width="2.5" height="1.2"
            visible="true"></a-plane>
          <!-- <a-entity text="value:helloo;color:black" position="6 2 14.25" id="txt1"></a-entity> -->
          <a-entity id="txt7" rotation="0 90 0" scale="1 1 1" position="6 2 14.25">
            <a-text id="txtval7" value="1234567" color="black"></a-text>
          </a-entity>
        </a-entity>
      </a-plane>
      <a-box id="pp7" position="23.621 0.100 -88.070" pulse-on-approach scale="1 1 1" color="red"></a-box>


<!-- stall 8-->
      <a-plane position="24.961 0.100 -67.721" color="white" width="15" height="15" rotation="90 180 0" side="double"
        class="trigger" alert-on-approach id="area8">
        <a-entity gltf-model="#stall" id="stall8" rotation="-90 0 0" position="-1.542 0.813 0.100" scale="0.85 0.85 0.85">
          <a-plane color="#FBFBFB" id="popup8" rotation="0 90 0" position="5.2 2 14.25" width="2.5" height="1.2"
            visible="true"></a-plane>
          <!-- <a-entity text="value:helloo;color:black" position="6 2 14.25" id="txt1"></a-entity> -->
          <a-entity id="txt8" rotation="0 90 0" scale="1 1 1" position="6 2 14.25">
            <a-text id="txtval8" value="1234567" color="black"></a-text>
          </a-entity>
        </a-entity>
      </a-plane>
      <a-box id="pp8" position="23.621 0.100 -60" pulse-on-approach scale="1 1 1" color="red"></a-box>


      <!-- stall 9 -->
      <a-plane position="24.85 0.100 -38.856" color="white" width="15" height="15" rotation="90 180 0" side="double"
        class="trigger" alert-on-approach id="area9">
        <a-entity gltf-model="#stall" id="stall9" rotation="-90 0 0" position="-1.542 0.813 0.100" scale="0.85 0.85 0.85">
          <a-plane color="#FBFBFB" id="popup9" rotation="0 90 0" position="5.2 2 14.25" width="2.5" height="1.2"
            visible="true"></a-plane>
          <!-- <a-entity text="value:helloo;color:black" position="6 2 14.25" id="txt1"></a-entity> -->
          <a-entity id="txt9" rotation="0 90 0" scale="1 1 1" position="6 2 14.25">
            <a-text id="txtval9" value="1234567" color="black"></a-text>
          </a-entity>
        </a-entity>
      </a-plane>
      <a-box id="pp9" position="23.621 0.100 -35" pulse-on-approach scale="1 1 1" color="red"></a-box>

<!-- stall 10 -->
      <a-plane position="25.098 0.100 -9.410" color="white" width="15" height="15" rotation="90 180 0" side="double"
        class="trigger" alert-on-approach id="area10">
        <a-entity gltf-model="#stall" id="stall10" rotation="-90 0 0" position="-1.542 0.813 0.100" scale="0.85 0.85 0.85">
          <a-plane color="#FBFBFB" id="popup10" rotation="0 90 0" position="5.2 2 14.25" width="2.5" height="1.2"
            visible="true"></a-plane>
          <!-- <a-entity text="value:helloo;color:black" position="6 2 14.25" id="txt1"></a-entity> -->
          <a-entity id="txt10" h rotation="0 90 0" scale="1 1 1" position="6 2 14.25">
            <a-text id="txtval10" value="1234567" color="black"></a-text>
          </a-entity>
        </a-entity>
      </a-plane>
      <a-box id="pp10" position="23.621 0.100 -5" pulse-on-approach scale="1 1 1" color="red"></a-box>

      <a-entity distance-trigger></a-entity>
    </a-entity>
  </a-scene>
  <script>

    document.getElementById('scene1').setAttribute('networked-scene', `room:${category}`)
    console.log(category)
    alert(category)
  </script>
  <script>


    AFRAME.registerComponent('distance-trigger', {
      init: function () {
        this.camera = document.getElementById('player');
        this.triggers = document.querySelectorAll('.trigger');
        this.distanceThreshold = 5; // Adjust as needed
        this.shownBoxes = new Set();
        this.triggeredBoxes = new Set();
        this.triggerEnterEvent = this.triggerEnterEvent.bind(this);
        this.triggerLeaveEvent = this.triggerLeaveEvent.bind(this);
      },
      update: function () {
        this.triggers.forEach(trigger => {
          trigger.addEventListener('triggerenter', this.triggerEnterEvent);
          trigger.addEventListener('triggerleave', this.triggerLeaveEvent);
        });
      },
      remove: function () {
        this.triggers.forEach(trigger => {
          trigger.removeEventListener('triggerenter', this.triggerEnterEvent);
          trigger.removeEventListener('triggerleave', this.triggerLeaveEvent);
        });
      },
      triggerEnterEvent: function (event) {
        const boxId = event.target.getAttribute('id');
        const textValue = event.target.querySelector('a-text').getAttribute('value');
        const message = 'Camera entered ' + boxId + '\nText value: ' + textValue;
        if (!this.shownBoxes.has(boxId)) {
          alert('Camera entered ' + message);
          this.shownBoxes.add(boxId);
          this.triggeredBoxes.add(boxId);
          //this.createAText(boxId);
         // document.getElementById("iframe-url").setAttribute('src', `http://chatapp.mc.in/cfmchat.cfm?stallid=${textValue}&bname=${textValue}sai&name=${localStorage.getItem('name')}`)
        }
        const textElement = document.getElementById(`txt${boxId}`);
        textElement.setAttribute('visible', 'true');
        textElement.setAttribute('animation', 'property: opacity; from: 1; to: 0; dur: 1000; easing: linear; loop: true');
      },
      triggerLeaveEvent: function (event) {
        const boxId = event.target.getAttribute('id');
        const textElement = document.getElementById(`txt${boxId}`);
        textElement.setAttribute('visible', 'false');
        textElement.removeAttribute('animation');
      },
      createAText: function (boxId) {
        const box = document.getElementById(boxId);
        const text = document.createElement('a-text');
        text.setAttribute('id', `txt${boxId}`)
        text.setAttribute('position', '0 0 0');
        text.setAttribute('value', 'This is ' + boxId);
        text.setAttribute('color', 'black'); // Change text color if necessary
        text.setAttribute('scale', '2 2 2'); // Adjust text size if necessary
        text.setAttribute('visible', 'false');
        box.appendChild(text);
      },
      tick: function () {
        var cameraPosition = this.camera.object3D.position;
        var self = this;

        this.triggers.forEach((trigger) => {
          // Get updated position of the trigger
          var triggerPosition = trigger.object3D.position;
          //  //console.log("trigger position")
          //   //console.log(triggerPosition)
          var distance = self.distance3D(cameraPosition, triggerPosition);
          // //console.log("the distance is ")
          // //console.log(distance)
          var boxId = trigger.getAttribute('id');

          if (distance <= self.distanceThreshold && !self.shownBoxes.has(boxId)) {
            trigger.emit('triggerenter');
          } else if (distance > self.distanceThreshold && self.triggeredBoxes.has(boxId)) {
            trigger.emit('triggerleave');
            self.triggeredBoxes.delete(boxId);
          }
        });
      },
      distance3D: function (point1, point2) {
        var dx = point1.x - point2.x;
        var dy = point1.y - point2.y;
        var dz = point1.z - point2.z;
        return Math.sqrt(dx * dx + dy * dy + dz * dz);
      }
    });

    AFRAME.registerComponent('alert-on-approach', {
      init: function () {
        this.triggered = false;
        this.camera = document.getElementById('player');

        this.stall = this.el;
        var id = this.stall.getAttribute('id');
        var textValue = document.getElementById(id).querySelector('a-entity').querySelector('a-text').getAttribute('value');
        //console.log(textValue);
        this.distanceThreshold = 6; // Adjust this threshold as needed

        this.checkDistance = this.checkDistance.bind(this);
        // var resetButton = document.getElementById('restartButton');
        // resetButton.addEventListener('click', () => {
        //   this.triggered = false;
        //   //console.log("triggerd")
        // });
        // resetButton.addEventListener('click', this.reset);

      },
      tick: function () {
        this.checkDistance();
      },
      checkDistance: function () {
        var cameraPosition = this.camera.getAttribute('position');
        var stallPosition = this.stall.getAttribute('position');
        var id = this.stall.getAttribute('id')
        var textValue = document.getElementById(id).querySelector('a-entity').querySelector('a-text').getAttribute('value');
        //  //console.log("stall position is")
        //  //console.log(stallPosition)
        //  //console.log("camera position is")
        //  //console.log(cameraPosition)
        var distance = this.camera.object3D.position.distanceTo(stallPosition);
        //  //console.log("the distance is")
        //  //console.log(distance)
        //  //console.log(distance < this.distanceThreshold)
        if (distance < this.distanceThreshold && !this.triggered) {
          // Perform your alert action here
          //    //console.log('Camera is near the stall');
          alert(`Camera is near the stall is ${id} and value is ${textValue}`);
          //document.getElementById("iframe-url").setAttribute('src', `http://chatapp.mc.in/cfmchat.cfm?stallid=${textValue}&bname=${textValue}sai&name=${localStorage.getItem('name')}`)
          this.triggered = true;
        }
      },
    });
    // $.ajax({
    //   url: "https://dev.marketcentral.in/rest/virtualExpo/general/getBusinesses",
    //   type: 'GET',
    //   dataType: 'json',
    //   success: function (response) {
    //     console.log(response);
    //     alert(response)
    //   }
    // }); 
  </script>
  <script>
    $('.closeIcon').click(function(){
        $('.popUp').css('display','none');
    })
</script>
</body>

</html>